<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>iOS越狱环境搭建 | Usopp&#39;s Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
    <meta name="description" content="Welcome">
  
  
    <meta name="keywords" content="iOS">
  
  
    <link rel="alternate" href="/atom.xml" title="Usopp's Page" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Usopp&#39;s Page</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> 首页</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> 归档</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> 关于</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> 订阅</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-jail-broken-env-build" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      iOS越狱环境搭建
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2021-05-17T09:54:01.000Z" itemprop="datePublished">2021年05月17日</time>
</span>
      
      
        <span class="article-views">
  <i class="fa fa-views"></i>
  <i id="busuanzi_container_page_pv">
      <i id="busuanzi_value_page_pv"></i>
  </i>
</span>

      
      
<a href="/2021/05/17/jail-broken-env-build/#comments" class="article-comment-link">
  
    
    
    
    
    
  
  <i class="fa fa-commt"></i>
  留言
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="越狱环境搭建与使用"><a href="#越狱环境搭建与使用" class="headerlink" title="越狱环境搭建与使用"></a>越狱环境搭建与使用</h1><h2 id="一、越狱"><a href="#一、越狱" class="headerlink" title="一、越狱"></a>一、越狱</h2><p>使用 <a target="_blank" rel="noopener" href="https://www.unc0ver.dev/">unc0ver</a> ，目前支持iOS 11.0 - 14.3，将它提供的 IPA 安装到设备上，打开即可进行一键越狱。官网提供了各种安装方式，采用最简单的重签名方式即可。</p>
<p>二、Cydia源与应用</p>
<p>越狱完成后就已经有了Cydia，添加各类源、安装各种插件与应用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># 源</span><br><span class="line">https://apt.binger.com/</span><br><span class="line"></span><br><span class="line">https://build.firda.re/</span><br><span class="line"></span><br><span class="line">https://getdelta.co/</span><br><span class="line"></span><br><span class="line">http://apt.thebigboss.org/reprofiles/cydia/</span><br><span class="line"></span><br><span class="line">Https://repo.dynastic.co/</span><br><span class="line"></span><br><span class="line">Https://cydia.angelxwind.net/</span><br><span class="line"></span><br><span class="line">http://apt.modmyi.com/</span><br><span class="line"></span><br><span class="line">https://repo.chariz.com</span><br><span class="line"></span><br><span class="line">https://repo.incendo.ws/</span><br><span class="line"></span><br><span class="line">https://tigisoftware.com/cydia/</span><br><span class="line"></span><br><span class="line">https://cydia.zodttd.com/repo/cydia/</span><br><span class="line"></span><br><span class="line"># 应用、插件</span><br><span class="line">Flex3、Flexible、OpenSSH、Frida</span><br><span class="line"></span><br><span class="line">AppSync Unified</span><br><span class="line">源：http://cydia.angelxwind.net/</span><br><span class="line">作用：允许安装未签名或破解的App</span><br><span class="line"></span><br><span class="line">Apple File Conduit &quot;2&quot; </span><br><span class="line">源：https://apt.xbsite.cn</span><br><span class="line">作用：允许通过USB访问手机系统目录</span><br><span class="line"></span><br><span class="line">AppList</span><br><span class="line">RocketBootstrap</span><br><span class="line">Preferenceloader</span><br><span class="line">源：https://rpetri.ch/repo/</span><br><span class="line">作用：允许插件访问设置列表及依赖</span><br><span class="line"></span><br><span class="line">Filza</span><br><span class="line">源：http://tigisoftware.com/cydia/</span><br><span class="line">作用：越狱设备必备文件管理器</span><br><span class="line"></span><br><span class="line">Flex</span><br><span class="line">源：http://getdelta.co/</span><br><span class="line">作用：图形化UI调整工具，必备</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ReProvision </span><br><span class="line">源：http://repo.incendo.ws</span><br><span class="line">作用：自动重签名应用工具</span><br><span class="line"></span><br><span class="line">P佬源</span><br><span class="line">源：https://pulandres.me/repo/</span><br><span class="line">作用：提供各种热门和谐版插件</span><br></pre></td></tr></table></figure>

<h2 id="三、连接iPhone与查看信息"><a href="#三、连接iPhone与查看信息" class="headerlink" title="三、连接iPhone与查看信息"></a>三、连接iPhone与查看信息</h2><p>通过SSH连接越狱设备，将iOS设备与电脑置于同一局域网下，默认密码 <code>alpine</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh root@10.252.24.149</span><br><span class="line">root@10.252.24.149&#x27;s password:</span><br><span class="line">Black:~ root#</span><br></pre></td></tr></table></figure>

<p>所有的应用位于 <code>/var/mobile/Containers/Data/Application/</code> 下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Black:~ root# cd /var/mobile/Containers/Data/Application/</span><br><span class="line">Black:/var/mobile/Containers/Data/Application root# ls</span><br><span class="line"></span><br><span class="line"># 输出</span><br><span class="line">013FD0C1-6076-4085-BA69-649770327965/  3EF80435-AE63-48A7-854B-1CC5A124FD1D/  7EEA33EE-345E-4F80-919F-C21D294D03C4/  BC003F9B-534F-47CD-AA2A-0CB58767A0ED/</span><br><span class="line">0163D32A-24C6-44C4-BC98-F8E909F69AEF/  3F628105-64BF-4B30-9DD6-D60D6296EF05/</span><br></pre></td></tr></table></figure>

<p>每个应用沙盒都是一个UUID，并不能直接与应用对应上，可以借助Cycript来查看</p>
<p>cycript使用</p>
<p>ssh连接iOS设备后，输入cycript启动cycript（出现 <code>cy#</code>提示符）</p>
<p>ps -e | grep ‘SpringBoard’ 获取进程id，可以将所有进程杀死，仅打开目标进程后执行，减少干扰项</p>
<p>cycript - p 1184（进程id） 注入进程</p>
<p>借助cycript在页面中展示一个弹窗</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cy# alertView = [[UIAlertView alloc] initWithTitle:@&quot;test&quot; message:@&quot;Cyrill&quot; delegate:nil cancelButtonTitle:@&quot;OK&quot; otherButtonTitles:nil]</span><br><span class="line">#&quot;&lt;UIAlertView: 0x156f9f0a0; frame = (0 0; 0 0); layer = &lt;CALayer: 0x156f96fc0&gt;&gt;&quot;</span><br><span class="line">cy# [alertView show]</span><br></pre></td></tr></table></figure>

<p>如果知道内存地址，也可以直接调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cy# [#0x156f9f0a0 show]</span><br></pre></td></tr></table></figure>



<h2 id="砸壳"><a href="#砸壳" class="headerlink" title="砸壳"></a>砸壳</h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/xFHA2tlc6HCLti_ihlrsZA">砸壳这件破事</a></p>
<h3 id="方式一-dumpdecrypted"><a href="#方式一-dumpdecrypted" class="headerlink" title="方式一: dumpdecrypted"></a>方式一: <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=https://github.com/stefanesser/dumpdecrypted">dumpdecrypted</a></h3><ol>
<li><p>越狱iOS设备安装 [Cycript]<a target="_blank" rel="noopener" href="http://www.cycript.org/">http://www.cycript.org/</a>) 与 [OpenSSH]<a target="_blank" rel="noopener" href="https://www.openssh.com/">https://www.openssh.com/</a>)</p>
</li>
<li><p>在Mac上 <code>git clone https://github.com/stefanesser/dumpdecrypted</code> </p>
</li>
<li><p>cd并执行 <code>make</code> 得到 <code>dumpdecrypted.dylib</code> </p>
</li>
<li><p>ssh连接到iOS设备</p>
</li>
<li><p><code>ps -e</code> 找到目前进程路径</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">root#</span><span class="bash"> ps -e</span></span><br><span class="line">1091 ??         0:03.35 /var/mobile/Containers/Bundle/Application/A5960257-7E26-45EC-A28C-315FCBB15852/WeChat.app/WeChat</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>cycript</code> 找到应用沙盒</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root# cycript -p WeChat</span><br><span class="line">// 将输出WeChat沙盒路径，如</span><br><span class="line">/var/mobile/Containers/Data/Application/05330136-5902-48C1-96A6-3C03F275DC73/Documents</span><br></pre></td></tr></table></figure>
</li>
<li><p>Mac上使用 scp 或 远程文件管理将前面得到的 <code>dylib</code> 拷贝到沙盒中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp ./dumpdecrypted.dylib root@192.168.2.2:/var/mobile/Containers/Data/Application/05330136-5902-48C1-96A6-3C03F275DC73/Documents</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入到沙盒，注入动态库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd /var/mobile/Containers/Data/Application/05330136-5902-48C1-96A6-3C03F275DC73/Documents$ DYLD_INSERT_LIBRARIES=dumpdecrypted.dylib /var/mobile/Containers/Bundle/Application/A5960257-7E26-45EC-A28C-315FCBB15852/WeChat.app/WeChat</span><br></pre></td></tr></table></figure>

<p>执行完成后，会在沙盒 <code>Documents</code> 内生成 <code>WeChat.decrypted</code> 文件</p>
</li>
<li><p>将 <code>WeChat.decrypted</code> 拷贝到 mac 中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp root@192.168.2.2:/var/mobile/Containers/Data/Application/05330136-5902-48C1-96A6-3C03F275DC73/Documents/WeChat.decrypted ~/dumpdecrypted</span><br></pre></td></tr></table></figure>

<p><code>WeChat.decrypted</code> 文件可用于 <code>class-dump</code> 或 <code>mach-o view</code> ，但不能用于跑 MonkeyDev。</p>
</li>
</ol>
<h2 id="方式二-Clutch"><a href="#方式二-Clutch" class="headerlink" title="方式二: Clutch"></a>方式二: <a target="_blank" rel="noopener" href="https://github.com/KJCracks/Clutch">Clutch</a></h2><p>不适用所有App，对于有 Extension 的app会失败，考虑使用 <a target="_blank" rel="noopener" href="https://github.com/AloneMonkey/frida-ios-dump">frida-ios-dump</a></p>
<ol>
<li>在 <a target="_blank" rel="noopener" href="https://github.com/KJCracks/Clutch/releases">release</a> 页下载最新版本，或下载源码自行编译</li>
<li>将Clutch scp到iOS设备的 <code>/usr/bin</code> 下</li>
<li>添加可执行权限 <code>chmod +x /usr/bin/Clutch</code></li>
<li>列出已安装的app <code>Clutch -i</code></li>
<li>砸壳 <code>Clutch -d 序号或bundleId</code></li>
<li>结果中会给出ipa路径，将ipa scp到mac上</li>
</ol>
<h2 id="方式三：LLDB砸壳"><a href="#方式三：LLDB砸壳" class="headerlink" title="方式三：LLDB砸壳"></a>方式三：LLDB砸壳</h2><p><a target="_blank" rel="noopener" href="http://4ch12dy.site/2020/02/26/lldb-how-to-dump-gracefully/lldb-how-to-dump-gracefully/"><strong>如何优雅的在LLDB里dumpdecrypted</strong></a></p>
<h2 id="方式三-frida-ios-dump"><a href="#方式三-frida-ios-dump" class="headerlink" title="方式三:  frida-ios-dump"></a>方式三:  <a target="_blank" rel="noopener" href="https://github.com/AloneMonkey/frida-ios-dump">frida-ios-dump</a></h2><ol>
<li><p>iOS上配置</p>
<ol>
<li>Cydia添加源: <a target="_blank" rel="noopener" href="https://build.frida.re">https://build.frida.re</a></li>
<li>搜索安装 frida</li>
<li>在手机终端运行 <code>frida-ps -U</code> 检查是否安装成功，检查失败也可砸壳</li>
</ol>
</li>
<li><p>mac端配置</p>
<ol>
<li><p>支持 <code>Python 2.x</code> 和 <code>3.x</code> 一般已带有 <code>pip</code> ，如果没有则自行安装 <code>pip</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install wgetwget https://bootstrap.pypa.io/get-pip.pysudo python get-pip.py清理残留: rm ~/get-pip.py</span><br></pre></td></tr></table></figure>
</li>
<li><p>克隆</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/AloneMonkey/frida-ios-dump</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd frida-ios-dumpsudo pip install -r requirements.txt --upgrade</span><br></pre></td></tr></table></figure>
</li>
<li><p>dump.py 中包含所使用的连接iOS用的用户名、密码、端口，如有需要进行修改，一般默认情况无需改动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User = &#x27;root&#x27;Password = &#x27;alpine&#x27;Host = &#x27;localhost&#x27;Port = 2222</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>usbmuxd</code> 或 <code>iproxy</code> 等通过 USB 转发 SSH 工具（默认 2222 -&gt; 22），例如: <code>iproxy 2222 22</code></p>
</li>
<li><p>列出安装的app <code>./dump.py -l</code> ，找到目标app复制bundleId</p>
</li>
<li><p>砸壳 <code>./dump.py bundleId</code>，完成后 IPA 会在 mac 当前目录下（此处也可以忽略上一步，直接使用应用中文名）</p>
</li>
<li><p>对于 SSH \ SCP 操作，确保将电脑上的公钥添加到iOS设备的 <code>~/.ssh/authorized_keys</code> 上</p>
</li>
</ol>
<h2 id="方式四-bagbak"><a href="#方式四-bagbak" class="headerlink" title="方式四: bagbak"></a>方式四: bagbak</h2><p><a target="_blank" rel="noopener" href="https://github.com/ChiChou/bagbak">bagbak</a> 也是基于 frida 但依赖项更少，更简洁，甚至不需要 ssh。</p>
</li>
</ol>
<h2 id="方式五"><a href="#方式五" class="headerlink" title="方式五:"></a>方式五:</h2><p>   <a target="_blank" rel="noopener" href="https://github.com/JohnCoates/flexdecrypt">flexdecrypt</a> ，一个接近静态脱壳的工具</p>
<h2 id="符号表恢复"><a href="#符号表恢复" class="headerlink" title="符号表恢复"></a>符号表恢复</h2><p><a target="_blank" rel="noopener" href="https://github.com/tobefuturer/restore-symbol">restore-symbol</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/HeiTanBc/restore-symbol">restore-symbol</a> 适配iOS14</p>
<p><a target="_blank" rel="noopener" href="http://4ch12dy.site/2019/07/02/xia0CallStackSymbols/xia0CallStackSymbols/">Frida调用栈符号恢复</a></p>
<p>此处以 restore-symbol 为例:</p>
<ol>
<li><p>克隆并编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone --recursive https://github.com/HeiTanBc/restore-symbol.gitcd restore-symbol &amp;&amp; make ./restore-symbol</span><br></pre></td></tr></table></figure>
</li>
<li><p>符号表恢复</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./restore-symbol /pathto/origin_mach_o_file -o /pathto/mach_o_with_symbol </span><br></pre></td></tr></table></figure>
</li>
<li><p>将新的 mach-o 放入 app中重签名，或直接放入 MonkeyDev 的 <code>TargetApp</code> 目录中的 .app 中</p>
</li>
</ol>
<h2 id="Block符号恢复"><a href="#Block符号恢复" class="headerlink" title="Block符号恢复"></a>Block符号恢复</h2><ol>
<li>下载Python脚本 <a target="_blank" rel="noopener" href="https://github.com/tobefuturer/restore-symbol/blob/master/search_oc_block/ida_search_block.py"><code>search_oc_block/ida_search_block.py</code></a> </li>
<li>用IDA打开目标mach-o文件，等待分析完成</li>
<li>菜单栏 <code>File-Script file...</code> 选择前面下载的脚本</li>
<li>等待脚本运行完成，在mach-o同级目录下会生成 <code>block_symbol.json</code> </li>
<li>重新运行 <code>restore-symol</code> </li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./restore-symbol /pathto/origin_mach_o_file -o /pathto/mach_o_with_symbol -j /pathto/block_symbol.json</span><br></pre></td></tr></table></figure>



<p>_printHierarchy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[[UIWindow keyWindow] rootViewController] _printHierarchy]&lt;MMUINavigationController 0x18392800&gt;, state: appeared, view: &lt;UILayoutContainerView 0x17f33790&gt;               | &lt;WCAccountLoginLastUserViewController 0x18b52600&gt;, state: appeared, view: &lt;UIView 0x192740d0&gt;</span><br></pre></td></tr></table></figure>

<p><strong>[[</strong>UIApp keyWindow<strong>]</strong> recursiveDescription<strong>]</strong></p>
<p>手机连接Xcode调试后，Xcode会将 debugServer 放到 <code>/Developer/usr/bin/</code> 下，我们将其拷贝到mac下，分离出指定架构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lipo -thin arm64 ~/debugserver -output ~/debugserver</span><br></pre></td></tr></table></figure>

<p>使用指定权限文件重签名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">plist</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="meta-string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">dict</span>&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.backboardd.debugapplications<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.backboardd.launchapplications<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.frontboard.debugapplications<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.frontboard.launchapplications<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.private.cs.debugger<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.private.logging.diagnostic<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.private.memorystatus<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.springboard.debugapplications<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>get-task-allow<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>platform-application<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>run-unsigned-code<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span>	<span class="tag">&lt;<span class="name">key</span>&gt;</span>task_for_pid-allow<span class="tag">&lt;/<span class="name">key</span>&gt;</span>	<span class="tag">&lt;<span class="name">true</span>/&gt;</span><span class="tag">&lt;/<span class="name">dict</span>&gt;</span><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codesign -s - --entitlements ent.plist -f debugserver</span><br></pre></td></tr></table></figure>

<h2 id="DebugServer-lldb-调试"><a href="#DebugServer-lldb-调试" class="headerlink" title="DebugServer + lldb 调试"></a>DebugServer + lldb 调试</h2><p>将<a target="_blank" rel="noopener" href="https://github.com/wstclzy2010/iOS-debugserver">处理好的debugServer </a>scp到手机的 <code>/usr/bin</code> 下，并添加可执行权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> iOS设备上chmod +x /usr/bin/debugserver</span></span><br></pre></td></tr></table></figure>

<p>这里之所以把处理过的 <code>debugserver</code> 存放在 iOS 的 <code>/usr/bin/</code> 下，而没有覆盖 <code>/Developer/usr/bin/</code> 下的原版 debugserver，一是因为原版 debugserver 是不可写的，无法覆盖；二是因为 <code>/usr/bin/</code> 下的命令无须输入全路径就可以执行，即在任意目录下运行 <code>debugserver</code> 都可启动处理过的 <code>debugserver</code>。</p>
<p>在 iOS 上启动想调试的应用后，开启 <code>debugServer</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debugserver *:1234 -a &quot;SpringBoard&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 示例输出Black:~ root<span class="comment"># debugserver *:1234 -a &quot;SpringBoard&quot;debugserver-@(#)PROGRAM:LLDB  PROJECT:lldb-1200.2.12 for arm64.Attaching to process SpringBoard...Listening to port 1234 for a connection from *...</span></span></span><br></pre></td></tr></table></figure>

<p><code>1234</code> 是我们指定的端口号，可以自行替换，<code>-a</code> 后接我们想调试的进程名</p>
<p>切换至mac上，首先进入 <code>lldb</code> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lldb(lldb)</span><br></pre></td></tr></table></figure>

<p>链接到手机的 debugServer</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process connect connect://iOSIP:1234</span><br></pre></td></tr></table></figure>

<p>连接过程可能耗时较长，需要等待一会。</p>
<p>如果在 <code>connect</code> 时报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: failed to get reply to handshake packet</span><br></pre></td></tr></table></figure>

<p>可以使用 <code>USB</code> 连接，切换到 <code>127.0.0.1</code> 然后使用 <code>iproxy</code> 转发</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 手机端debugserver 127.0.0.1:1234 -a &quot;SpringBoard&quot;# mac端1iproxy 1234 1234# mac端2lldbprocess connect connect://127.0.0.1:1234</span><br></pre></td></tr></table></figure>

<h2 id="Theos越狱插件Tweak开发"><a href="#Theos越狱插件Tweak开发" class="headerlink" title="Theos越狱插件Tweak开发"></a>Theos越狱插件Tweak开发</h2><p>参考: <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a5435650e828">iOS 越狱的Tweak开发</a></p>
<h3 id="1-Theos-安装"><a href="#1-Theos-安装" class="headerlink" title="1. Theos 安装"></a>1. Theos 安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/theos/theos.git /opt/theos</span><br></pre></td></tr></table></figure>

<p>一般情况放在 <code>/opt/theos</code> 下，也可以更换到自定义路径。完成后建立环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> THEOS=/opt/theos</span><br></pre></td></tr></table></figure>

<p>为了后续使用方便，可以将环境变量写入到 <code>zshrc</code> 或 <code>bash_profile</code>等文件中，让全局终端都能生效。</p>
<h3 id="2-其他安装"><a href="#2-其他安装" class="headerlink" title="2. 其他安装"></a>2. 其他安装</h3><p>安装 <code>ldid</code> 和 <code>dpkg</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ldidbrew install dpkg</span><br></pre></td></tr></table></figure>

<p><code>ldid</code> 是用来替代 <code>codesign</code> 进行签名的，让插件 <code>deb</code> 产物能顺利安装到手机上。</p>
<p><code>dpkg</code> 是 <code>theos</code> 用来把工程打包成 <code>deb</code> 文件用的。</p>
<h3 id="3-创建新的插件"><a href="#3-创建新的插件" class="headerlink" title="3. 创建新的插件"></a>3. 创建新的插件</h3><p>打开终端执行 <code>$THEOS/bin/nic.pl</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NIC 2.0 - New Instance Creator------------------------------  [1.] iphone/activator_event  [2.] iphone/activator_listener  [3.] iphone/application_modern  [4.] iphone/application_swift  [5.] iphone/cydget  [6.] iphone/flipswitch_switch  [7.] iphone/framework  [8.] iphone/library  [9.] iphone/notification_center_widget  [10.] iphone/notification_center_widget-7up  [11.] iphone/preference_bundle_modern  [12.] iphone/theme  [13.] iphone/tool  [14.] iphone/tool_swift  [15.] iphone/tweak  [16.] iphone/tweak_with_simple_preferences  [17.] iphone/xpc_serviceChoose a Template (required): </span><br></pre></td></tr></table></figure>

<p>输入 15 选择 <code>iPhone/tweak</code> 。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Project Name (required):myTweak</span><br></pre></td></tr></table></figure>

<p>输入插件名称。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Package Name [com.yourcompany.mytweak]:</span><br></pre></td></tr></table></figure>

<p>输入包名或输入回车使用提供的默认包名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Author/Maintainer Name [lindubo]:</span><br></pre></td></tr></table></figure>

<p>输入作者名或输入回车使用默认。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[iphone/tweak] MobileSubstrate Bundle filter [com.apple.springboard]:</span><br></pre></td></tr></table></figure>

<p>输入插件要作用的包名（进程名？），如  <code>com.apple.UIKit</code> 可以作用于所有App，如 <code>com.apple.webinspectord</code> 作用于<code>webinspectord</code> 的守护进程。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[iphone/tweak] List of applications to terminate upon installation (space-separated, <span class="string">&#x27;-&#x27;</span> <span class="keyword">for</span> none) [SpringBoard]:</span><br></pre></td></tr></table></figure>

<p>输入插件安装完成后需要重新的进程名完成创建，创建完后目录结构为:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.└── mytweak    ├── Makefile    ├── Tweak.x    ├── control    └── myTweak.plist</span><br></pre></td></tr></table></figure>

<p>其中 <code>control</code> 文件记录了插件相关的信息:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat controlPackage: com.yourcompany.mytweakName: myTweakVersion: 0.0.1Architecture: iphoneos-armDescription: An awesome MobileSubstrate tweak!Maintainer: linduboAuthor: linduboSection: TweaksDepends: mobilesubstrate (&gt;= 0.9.5000)</span><br></pre></td></tr></table></figure>

<p>而 <code>plist</code> 文件中记录了前面输入的插件作用的目标包名:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; Filter = &#123; Bundles = ( <span class="string">&quot;com.apple.webinspectord&quot;</span> ); &#125;; &#125;</span><br></pre></td></tr></table></figure>

<p><code>makefile</code> 用来编译工程:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat MakefileTARGET := iphone:clang:latest:7.0INSTALL_TARGET_PROCESSES = SpringBoardinclude $(THEOS)/makefiles/common.mkTWEAK_NAME = myTweakmyTweak_FILES = Tweak.xmyTweak_CFLAGS = -fobjc-arcinclude $(THEOS_MAKE_PATH)/tweak.mk</span><br></pre></td></tr></table></figure>

<p>里面引用了 <code>$THEOS</code> 环境变量，因此前面需要先设置好环境变量。</p>
<p><code>tweak.xm</code> 是我们需要编译的文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat Tweak.x/* How to Hook with LogosHooks are written with syntax similar to that of an Objective-C @implementation.You don<span class="string">&#x27;t need to #include &lt;substrate.h&gt;, it will be done automatically, as willthe generation of a class list and an automatic constructor.%hook ClassName// Hooking a class method+ (id)sharedInstance &#123;	return %orig;&#125;// Hooking an instance method with an argument.- (void)messageName:(int)argument &#123;	%log; // Write a message about this call, including its class, name and arguments, to the system log.	%orig; // Call through to the original function with its original arguments.	%orig(nil); // Call through to the original function with a custom argument.	// If you use %orig(), you MUST supply all arguments (except for self and _cmd, the automatically generated ones.)&#125;// Hooking an instance method with no arguments.- (id)noArguments &#123;	%log;	id awesome = %orig;	[awesome doSomethingElse];	return awesome;&#125;// Always make sure you clean up after yourself; Not doing so could have grave consequences!%end*/</span></span><br></pre></td></tr></table></figure>

<p>其中 <code>%hook</code> 、 <code>%orig</code> 、<code>%log</code> 都是 <code>theos</code> 对 <code>Cydia Substrate</code> 提供的函数的宏封装，介绍和示例可以参考<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://iphonedevwiki.net/index.php/Cydia_Substrate">Cydia_Substrate</a>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IMP MSHookMessage(Class class, SEL selector, IMP replacement, const char* prefix); &gt; // prefix should be NULL. void MSHookMessageEx(Class class, SEL selector, IMP replacement, IMP *result); void MSHookFunction(void* function, void* replacement, void** p_original);</span><br></pre></td></tr></table></figure>

<p><code>Cydia Substrate</code> 还提供了 <code>MobileLoader</code> ，上面的这些钩子需要在运行时被加载就是由于  <code>MobileLoader</code> 会在适当的时机加载越狱设备上 <code>/Library/MobileSubstrate/DynamicLibraries/</code> 目录里的动态库，我们的 <code>tweak</code> 最终产物就是动态库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...// The attribute forces this function to be called on load.__attribute__((constructor))static void initialize() &#123;  NSLog(@&quot;MyExt: Loaded&quot;);  MSHookFunction(CFShow, replaced_CFShow, &amp;original_CFShow);&#125;</span><br></pre></td></tr></table></figure>

<p>另外由于 <code>__attribute__((constructor))</code> 的执行时机早于 <code>main</code> 函数，因此钩子得以在较早的时机执行。</p>
<p><code>tweak</code> 文件的后缀名中，<code>.x</code> 表示支持 <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://iphonedevwiki.net/index.php/Logos">logos</a> 语法和 C语法；<code>.xm</code> 表示支持 <a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://iphonedevwiki.net/index.php/Logos">logos</a> 语法和 C/C++ 语法。</p>
<h3 id="编译与安装"><a href="#编译与安装" class="headerlink" title="编译与安装"></a>编译与安装</h3><p>编译deb包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make packages</span><br></pre></td></tr></table></figure>

<p>完成后会多出 <code>.theos</code> 目录，和 <code>packages</code> 目录。动态库产物在 <code>./theos/_/Library/MobileSubstrate/DynamicLibraries/</code> 下，<code>deb</code> 产物在 <code>packages</code> 目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tree -a -L 2.├── .theos│   ├── _│   ├── build_session│   ├── fakeroot│   ├── last_package│   ├── obj│   └── packages├── Makefile├── Tweak.x├── control├── myTweak.plist└── packages    └── com.yourcompany.mytweak_0.0.1-1+debug_iphoneos-arm.deb5 directories, 8 files</span><br></pre></td></tr></table></figure>

<h4 id="使用iFile安装"><a href="#使用iFile安装" class="headerlink" title="使用iFile安装"></a>使用iFile安装</h4><ol>
<li>使用工具将 <code>deb</code> 文件拷贝到手机上，可以通过 <code>ssh</code> 或其他工具</li>
<li>手机上使用 <code>iFile</code> 打开进行安装</li>
</ol>
<h4 id="ssh直接编译-安装"><a href="#ssh直接编译-安装" class="headerlink" title="ssh直接编译+安装"></a>ssh直接编译+安装</h4><p>在 <code>Makefile</code> 最前面加上:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">THEOS_DEVICE_IP=IP_Of_iPhone</span><br></pre></td></tr></table></figure>

<p>然后执行 <code>make package install</code> 即可将产物直接安装到设备上。</p>
<p>如果需要指定端口，也可以再加上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">THEOS_DEVICE_PORT=2222</span><br></pre></td></tr></table></figure>

<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><p>安装的插件可以直接在 <code>Cydia</code> 中进行删除。</p>
<p>如果手机上安装了 <code>dpkg</code> (Debian Package)，可以在手机终端上执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 安装dpkg -i path/to/deb# 安装后重启SpringBoardkillall -HUP SpringBoard# 卸载，参数为插件的packageNamedpkg -r packageName</span><br></pre></td></tr></table></figure>

<p>deb实际上是一个压缩包，如果使用其他压缩软件解压会丢失原有文件的权限信息，因此可以用 <code>dpkg-deb</code> 来解包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加压dpkg-deb -x abc.deb tmp #将abc.deb的程序文件解包到tmp文件夹dpkg-deb -e abc.deb tmp/DEBIAN #将abc.deb的安装控制/识别信息解包到DEBIAN文件夹# 打包# 假设将需要打包的文件放在tmp文件夹中，DEBIAN文件夹也要在放在这个文件夹中，然后输入命令：chmod -R 0755 tmp/DEBIAN #首先设置权限，如果没有包含脚本可以不需要设置权限dpkg-deb -b tmp 1.deb #打包成一个叫做1.deb的包</span></span><br></pre></td></tr></table></figure>

<p>进入DEBIAN目录，可以看到有一个control文件，无后缀名，这个文件就是用来记录deb的安装信息。</p>
<h3 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -U</span><br></pre></td></tr></table></figure>



<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/xFHA2tlc6HCLti_ihlrsZA">砸壳这件破事</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a5435650e828">iOS 越狱的Tweak开发</a></p>
<p><a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/2020/02/01/5e353c6612dc9/">在iOS上使用Frida</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26845694">在iOS应用程序中使用Frida绕过越狱检测</a></p>

        
            <div id="toc-article">
                
  <div class="widget-wrap" id="toc-wrap">
    <h3 class="widget-title"><i class="fa fa-toc"></i> 文章目录</h3>
    <div class="widget">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B6%8A%E7%8B%B1%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text">越狱环境搭建与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%B6%8A%E7%8B%B1"><span class="toc-text">一、越狱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%BF%9E%E6%8E%A5iPhone%E4%B8%8E%E6%9F%A5%E7%9C%8B%E4%BF%A1%E6%81%AF"><span class="toc-text">三、连接iPhone与查看信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A0%B8%E5%A3%B3"><span class="toc-text">砸壳</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80-dumpdecrypted"><span class="toc-text">方式一: dumpdecrypted</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C-Clutch"><span class="toc-text">方式二: Clutch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%89%EF%BC%9ALLDB%E7%A0%B8%E5%A3%B3"><span class="toc-text">方式三：LLDB砸壳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%89-frida-ios-dump"><span class="toc-text">方式三:  frida-ios-dump</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E5%9B%9B-bagbak"><span class="toc-text">方式四: bagbak</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%94"><span class="toc-text">方式五:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E8%A1%A8%E6%81%A2%E5%A4%8D"><span class="toc-text">符号表恢复</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Block%E7%AC%A6%E5%8F%B7%E6%81%A2%E5%A4%8D"><span class="toc-text">Block符号恢复</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DebugServer-lldb-%E8%B0%83%E8%AF%95"><span class="toc-text">DebugServer + lldb 调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Theos%E8%B6%8A%E7%8B%B1%E6%8F%92%E4%BB%B6Tweak%E5%BC%80%E5%8F%91"><span class="toc-text">Theos越狱插件Tweak开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Theos-%E5%AE%89%E8%A3%85"><span class="toc-text">1. Theos 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B6%E4%BB%96%E5%AE%89%E8%A3%85"><span class="toc-text">2. 其他安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E6%8F%92%E4%BB%B6"><span class="toc-text">3. 创建新的插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-text">编译与安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8iFile%E5%AE%89%E8%A3%85"><span class="toc-text">使用iFile安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ssh%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%AF%91-%E5%AE%89%E8%A3%85"><span class="toc-text">ssh直接编译+安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-text">删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Frida"><span class="toc-text">Frida</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
  </div>


            </div>
        
        
          <blockquote id="copyright">
              <p>原文链接: <a href="https://sleepearlier.github.io/2021/05/17/jail-broken-env-build/">https://sleepearlier.github.io/2021/05/17/jail-broken-env-build/</a></p>
              <p>版权声明: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>分享到:</span>
    </div>



        </div>
      
      
        
<nav id="article-nav">
  
  
    <a href="/2021/01/25/%E5%88%9D%E6%8E%A2iOS%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95%E5%8E%9F%E7%90%86/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">older</strong>
      <div class="article-nav-title">初探iOS源码调试原理</div>
    </a>
  
</nav>

      
      
        







      
    </footer>
  </div>
</article>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> 最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/05/17/jail-broken-env-build/">iOS越狱环境搭建</a>
          </li>
        
          <li>
            <a href="/2021/01/25/%E5%88%9D%E6%8E%A2iOS%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95%E5%8E%9F%E7%90%86/">初探iOS源码调试原理</a>
          </li>
        
          <li>
            <a href="/2019/10/25/%E4%BD%BF%E7%94%A8space%E7%AE%A1%E7%90%86provisionProfile/">使用space管理provisionProfile</a>
          </li>
        
          <li>
            <a href="/2019/10/10/First-Blood/">在已有原生工程中集成Flutter</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> 标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Flutter/" style="font-size: 10px;">Flutter</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-classify"></i> 分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> 归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021年05月</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019年10月</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> 标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flutter/" rel="tag">Flutter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/" rel="tag">iOS</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> 友情链接</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example1.com/">site-name1</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example2.com/">site-name2</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="http://www.example3.com/">site-name3</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">网站地图</a>
        <span> | </span><a href="/atom.xml">订阅本站</a>
        <span> | </span><a href="/about/">联系博主</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2021 Usopp.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        
            <span>Count by <a href="http://busuanzi.ibruce.info/" target="_blank">busuanzi.</a></span>
        
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
    
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  
<script src="/localshare/js/social-share.js"></script>

  
<script src="/localshare/js/qrcode.js"></script>




















  </div>
</body>
</html>